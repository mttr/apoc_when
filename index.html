<!-- vim:set et ai sw=4 ts=4: -->
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>
    <title>Apocalypse When...?</title>
    <link type="text/css" rel="stylesheet" href="css/materialize.css"  media="screen,projection"/>
    <style type="text/css" media="screen">
    .main > * {
        text-align: center;
    }
    </style>
</head>
<body>
<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="js/materialize.js"></script>
<script type="text/javascript" charset="utf-8">
var quizDate = new Date();
var wins = 0;
var losses = 0;

function randomDate(start, end) {
    return new Date(start.getTime() + Math.random() * (end.getTime() - start.getTime()));
}

function setRandomDate() {
    quizDate = randomDate(new Date(2015, 0, 1), new Date(2015, 11, 31));
    date.textContent = quizDate.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
    day.selectedIndex = 0;
}

function checkAnswer() {
    var selected = day.selectedIndex;

    if (selected == 0) return;

    var success = selected - 1 == quizDate.getDay();
    results.textContent = success;

    if (success) {
        wins++;
        setRandomDate();
    } else {
        losses++;
    }
    updateScore();
}

function updateScore() {
    score_wins.textContent = "Wins: " + wins;
    score_losses.textContent = "Losses: " + losses;

    var d = losses + wins;

    if (d > 0) {
        score_percent.textContent = "Percent: " + (wins / d) * 100;
    } else {
        score_percent.textContent = "Percent: 0";
    }
}

window.onload = function() {
    setRandomDate();
    updateScore();
    $('select').material_select();
};
</script>
<nav class="light-blue" role="navigation">
    <div class="container">
        <div class="nav-wrapper">
            <div id="logo-container" class="brand-logo center" href="#">Apocalypse When...?</div>
        </div>
    </div>
</nav>
<br/>
<br/>
<div class="container">
    <div class="section">
        <div class="main row">
            <div class="col m4 s12"><select name="day" id="day">
                <option disabled selected>Pick Day</option>
                <option>Sunday</option>
                <option>Monday</option>
                <option>Tuesday</option>
                <option>Wednesday</option>
                <option>Thursday</option>
                <option>Friday</option>
                <option>Saturday</option>
            </select></div>
            <div class="col m4 s12 valign-wrapper"><h5 id=date class="light"></id></div>
            <div class="col m4 s12"><button class="btn-large waves-effect waves-light" type="button" id=checkAnswer onclick="checkAnswer()">Answer</button></div>
        </div>
        <div id=results></div>
        <br/>
        <div id=score>
            <div id="score_wins"></div>
            <div id="score_losses"></div>
            <div id="score_percent"></div>
        </div>
    </div>
</div>
</body>
</html>
